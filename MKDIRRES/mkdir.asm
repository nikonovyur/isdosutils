	ORG  #61A8	DEFB	#00	DEFB	#00	DEFB	#00	DEFB	#00	LD   C,#33	RST  #10       EXX	LD   A,D	CP   #6	INC  A	RET  NC	LD   IX,L620C       LD   A,(L620B)	LD   (IX+#4),A       LD   A,#01	LD   C,#61	RST  #10       LD   C,#66       RST  #10; Подсвечиваем строку ввода       LD   D,(IX+#00)       LD   E,(IX+#03)       LD   (IX+#00),2       LD   (IX+#03),27       LD   A,2       LD   HL,LINECO       LD   B,(HL)       LD   C,#64       RST  #10       LD   (IX+#03),E       LD   (IX+#00),D       LD   HL,L624D	LD   B,#8L61DE	DEC  HL	LD   (HL),#20	DJNZ L61DEL61E3	EX   DE,HL; Установка координат печати в окне       LD   HL,#0201       LD   C,#6B       RST  #10; Строковый мобильный редактор       EX   DE,HL       LD   A,#08       LD   DE,#0A01       LD   BC,#016E       RST  #10       JR   NZ,L6202	OR   A	JR   Z,L6202	LD   A,#20	LD   C,#50	RST  #10       JR   C,L61E3      ; Повторить ввод       JR   L6228        ; Создать каталогL6202	XOR  A       LD   A,#F2       RET       DEFM "UnCo"       DEFB COLZL620B	DEFB	#38LINECO DEFB %00101000COLZ   EQU  $-L620BL6228	LD   C,#45	RST  #10       EXX	DEC  HL	DEC  HL	LD   B,(HL)	DEC  HL       LD   C,(HL)       ; Получаем в BC текущую дату       LD   (L6263),BC   ; Сохраняем в последние 2 байта дескриптора	LD   HL,L6245       LD   C,#23        ;Создаём каталог	RST  #10       RET  C       EXX       LD   BC,#000B	ADD  HL,BC       LD   A,(HL)       ; Читаем а A CSR каталога	LD   C,#6       ADD  HL,BC        ; Переходим на номер блока описателя сегмента	LD   E,(HL)	INC  HL       LD   D,(HL)       ; Читаем его в DE       AND  #40          ; Проверяем на непрерывный каталог	JR   NZ,L6283       RST  #10          ; C,#06 DE-номер блока описателя сегментов, читаем его в кэш HL'-адрес блока в кэше	RET  C       EXX	INC  HL	LD   E,(HL)	INC  HL	LD   D,(HL)	PUSH DE       EXX       POP  DE           ; Получили в DE номер первого блока каталогаL6283	INC  HL	LD   (HL),E	INC  HL	LD   (HL),D       LD   C,#28        ; Сохранили изменённый дескриптор	RST  #10	RET  C	PUSH DE       LD   BC,#FFEC	ADD  HL,BC       LD   BC,#0020	LD   DE,L6245       LDIR              ; накатили дескриптор из системы       LD   C,#10	ADD  HL,BC	LD   A,(HL)	INC  HL	INC  HL	INC  HL	LD   E,(HL)	INC  HL	LD   D,(HL)       INC  HL       INC  HL       INC  HL       OR   (HL)       INC  A	LD   (L6251),DE       LD   (LVCAT),A	LD   A,#1       LD   (L625A),A    ; количество файлов в каталоге, включая сам каталог	POP  DE	LD   C,#6	RST  #10       RET  C       EXX	PUSH DE	EX   DE,HL	LD   HL,L6245       LD   BC,#0020       LDIR	LD   C,#DF	LD   L,E	LD   H,D	INC  DE	LD   (HL),#0       LDIR	POP  DE	LD   C,#2E	RST  #10	RET  C	LD   HL,(L6253)	LD   A,L	OR   A	LD   A,H	JR   NZ,L62D6	DEC  AL62D6	OR   A       JR   Z,EXITFL       LD   B,A       LD   DE,#0001L62DC	LD   C,#2D	RST  #10	RET  C       EXX	XOR  A	LD   B,AL62E3	LD   (HL),A	INC  HL	DJNZ L62E3	PUSH DE       EXX	POP  HL	EX   DE,HL	LD   C,#2E	RST  #10	RET  C	EX   DE,HL	INC  DE	DJNZ L62DCEXITFL LD   C,#2       RST  #10L6240  RET  C       XOR  A       LD   A,#F2       RET; Вектор окнаL620C  DEFB #01       DEFB #09       DEFB #05       DEFB #1D       DEFB #38       DEFB #01       DEFB #03       DEFB #24       DEFM "╔═══════ Создание каталога ═══════╗"       DEFB #0D       DEFM "║                                 ║"       DEFB #0D       DEFM "╚═════════════════════════════════╝"       DEFB #03; Дескриптор каталогаL6245  DEFB "C"       DEFB "A"       DEFB "T"       DEFB "A"       DEFB "L"       DEFB "O"       DEFB "G"       DEFB #20L624D  DEFB #20       DEFB #20       DEFB #20       DEFB #21L6251  DEFB #00       DEFB #00L6253  DEFB #00       DEFB #03L6255  DEFB #00       DEFB #00       DEFB #00       DEFB #00       DEFB #00L625A  DEFB #00       DEFB #00LVCAT  DEFB #00       DEFB #00       DEFB #00       DEFB #00       DEFB #00       DEFB #00       DEFB #00L6263  DEFB #00       DEFB #00
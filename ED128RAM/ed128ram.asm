	ORG  #C350L3B	EQU	#3BL69	EQU	#69L101	EQU	#101L7FFD	EQU	#7FFDLC000	EQU	#C000       DEFW #0000       DEFW LC360       ; $read       DEFW LC368       ; $write       DEFW LC3B9       ; $binit       DEFB #E0         ; регистр состояния       DEFB #04         ; ещё регистр состояния	DEFB	#00	DEFB	#00	DEFB	#00	DEFB	#00	DEFB	#00	DEFB	#00LC360  EXX       LD   A,#EB        ; A = код команды EX DE,HL       LD   HL,LC3BB     ; адрес подпрограммы чтения	JR   LC36DLC368  EXX       XOR  A            ; A = код команды NOP       LD   HL,LC3CE     ; адрес подпрограммы записиLC36D	LD   (LC398),A	LD   (LC39C),A	LD   (LC3B0),HL       EXX	PUSH HL	LD   A,B       EXX	POP  DE	AND  A	LD   HL,LC000	LD   B,A	SBC  HL,DE       EXX	JR   C,LC3A5       EXX	LD   A,H	SUB  B	LD   A,#0	JR   NC,LC38F	LD   A,B	SUB  H	LD   B,HLC38F	PUSH AF	LD   A,B       EXX	LD   B,ALC393	PUSH HL	CALL LC3DF	EX   (SP),HLLC398	EX   DE,HL	CALL L3BLC39C	EX   DE,HL	POP  DE	LD   B,A	AND  A	JR   NZ,LC393	POP  AF	AND  A	RET  ZLC3A5	LD   B,A	PUSH HL	CALL LC3DF	EX   (SP),HL	PUSH AFLC3AC	PUSH BC	LD   B,#1	CALL LC3BBLC3B0	EQU	$-#2	POP  BC	DJNZ LC3AC	POP  AF	POP  DE	JR   NZ,LC3A5LC3B9  XOR  A       RETLC3BB	PUSH HL	LD   HL,L101	PUSH BC	PUSH HL	EX   DE,HL	CALL L3B	POP  DE	POP  BC	EX   (SP),HL	EX   DE,HL       LDIR	EX   DE,HL	POP  DE       RETLC3CE	PUSH DE	LD   DE,L101	PUSH BC	PUSH DE       LDIR	POP  DE	POP  BC	EX   (SP),HL	EX   DE,HL	CALL L3B	POP  HL       RETLC3DF	LD   A,B	PUSH DE	PUSH DE       EXX	EX   AF,AF'	POP  BC	LD   A,C	AND  #3F	LD   D,A	LD   A,#40	SUB  D	LD   HL,LC000	LD   E,L	ADD  HL,DE	PUSH HL	LD   L,A	EX   AF,AF'	LD   E,A	LD   A,L	SUB  E	LD   A,#0	JR   NC,LC3FE	LD   A,E	SUB  L	LD   E,LLC3FE	LD   D,A	SLA  C	RL   B	SLA  C	RL   B	LD   C,B	LD   B,#0	LD   HL,L69	ADD  HL,BC	LD   L,(HL)	LD   BC,L7FFD	LD   H,#10	PUSH DE       EXX	POP  BC	LD   A,B	POP  DE	POP  HL	LD   B,#0	ADD  HL,BC	LD   B,C	LD   C,#0	AND  A       RET
;  6.2.95   RENUMB; 19.4.93   15:22; 17.4.93   16:02; mask.as;      mask.com	ORG	24000*L+DEBUG	EQU	0*L-;=604	IF	DEBUG	IM	1	JP	32000	END	LD	HL,BUFF	LD	HL,(BUFF)	XOR	A	LD	DE,#C9C9	LD	(BUFF),DE	SBC	HL,DE	LD	HL,BUFF+2	LD	DE,mask	JR	Z,$+3	EX	DE,HL	LD	BC,12	LDIR;      IF   0;option:;0: /+ plus;FF:/- minus;1: /m mark       LD   C,$g_com	RST	16	EXX	DEC	HL	DEC	HL	DEC	HL	DEC	HL	LD	D,(HL)	DEC	HL	LD	E,(HL)OPCAT	LD	A,(DE)	INC	DE	CP	13	JR	Z,OPTIX	CP	" "	JR	Z,OPCAT	CP	"/"	JR	NZ,OPMASK	LD	A,(DE);      RES  5,A	LD	HL,OBUFF	LD	BC,#3FFSPORT	CP	(HL)	JR	Z,SETTER	INC	C	INC	HL	DJNZ	SPORT	JR	OPCATSETTER	LD	HL,REGIM+1	LD	(HL),C	INC	DE	JR	OPCAT;-------------OBUFF	DEFM	|-+m|OPMASK	LD	BC,#C0C	LD	HL,mask	PUSH	HL	LD	(HL)," "	INC	HL	DJNZ	$-3	POP	HL	EX	DE,HL	DEC	HLOPM_1	LD	A,(HL)	CP	" "	JR	Z,OPMEX	CP	13	JR	Z,OPMEX	LDI	JP	PE,OPM_1OPMEX	EX	DE,HL	JR	OPCAT;----------------------OPTIX	LD	(STACK+1),SP	LD	A,(REGIM+1)	CP	22	JR	NZ,mark;      END       LD   C,$g_cur	RST	16	EXX	LD	IX,`MENU	DJNZ	WT	LD	(IX),18	LD	(IX+6),26WT	LD	HL,(COLOR)	LD	(`MENU+4),HL	LD	HL,(COLOR+2)	LD	(IX-10),L	LD	(IX-12),H	XOR	A       LD   C,$wt	RST	16       LD   C,$menu	RST	16	JR	EXIT_1;--------------	DEFM	|UnCo|	DEFB	COLSZCOLOR	DEFB	7,1,#38,6COLSZ	EQU	$-COLOR;------------------------Mark	LD	A,1	JR	markPLUS	XOR	A	JR	markMINUS	OR	#FFmark	IF	DEBUG	IM	1	END	LD	(REGIM+1),ASTACK	LD	SP,0NEXT	LD	HL,FNUMB+1	INC	(HL)	LD	A,(HL)       LD   C,$opnum	RST	16	JR	NC,OPOK	CP	80	JR	Z,EXIT	SCF	RET;---------------------EXIT	LD	A,(FNUMB+1)	LD	B,A       LD   E,0RENUMB       INC  E       LD   C,$^_csr	RST	16	EXX	BIT	1,(HL)	DEC	HL	LD	(HL),0	JR	Z,EX_NXNUMB	LD	(HL),1	LD	HL,NUMB+1	INC	(HL)EX_NX	EXX	DJNZ	RENUMB       LD   C,$gmpan	RST	16	EXX	LD	HL,18	ADD	HL,DE	LD	A,(NUMB+1)	DEC	A	LD	(HL),AEXIT_1	XOR	A	LD	A,#F8	RET;---------------------OPOK	EXX	LD	BC,11	LD	DE,FILE	PUSH	DE	LDIR	LD	A,(HL)	POP	HL	RRCA	JR	NC,NEXT	AND	#10 ; CAT	JR	NZ,NEXT; Compare:	LD	B,8	LD	DE,mask	XOR	A	LD	(EXTNT+1),A	LD	(WILD+1),A	LD	(CPCSR+1),ACompas	LD	A,(DE);      CP   13;      JR   Z,CMP_OK	CP	" "	JP	Z,SPACE	CP	"*"	JR	Z,Wild	CP	"?"	JR	Z,SKIP	CP	"."	JR	Z,DOTCMP	PUSH	AF	LD	A,(CPCSR+1)	OR	A	JR	NZ,CMP_1	LD	(HL_CP+1),HL	LD	(DE_CP+1),DE	LD	(BC_CP+1),BCCMP_1	POP	AF	LD	(CPCSR+1),A	CP	(HL)	JR	NZ,cmp_NoSKIP	INC	DE	INC	HL	DJNZ	CompasEXTNT	LD	A,0	OR	A	JR	NZ,CMP_OK	LD	(CPCSR+1),A	DEC	A	LD	(EXTNT+1),A	LD	B,3	JR	Compas;--------------------Wild	LD	(WILD+1),A	XOR	A	LD	(CPCSR+1),AWILDEX	INC	DEcomp	JR	Compas;--------------------DOT	LD	(EXTNT+1),A	LD	A,(CPCSR+1)	OR	A	JR	Z,DOT_EX	LD	A,(WILD+1)	OR	A	JR	Z,SP_DOT	LD	HL,FILE+8DOT_1	DEC	HL	LD	A,(HL)	CP	" "	JR	Z,DOT_1	PUSH	DEDOT_CP	DEC	DE	LD	A,(DE)	CP	"*"	JR	Z,DOT_OK	CP	"?"	JR	Z,DOT_NX	CP	(HL)DOT_NX	DEC	HL	JR	Z,DOT_CP	POP	DE	JR	CMP_NO;--------------DOT_OK	POP	DEDOT_EX	LD	HL,FILE+8	LD	B,3	XOR	A	JR	Wild;--------------SP_DOT	CALL	SP_TST	JR	NZ,CMP_NO	JR	DOT_EX;--------------------cmp_NoWILD	LD	A,0	OR	A	JR	Z,CMP_NO	XOR	A	LD	(CPCSR+1),AHL_CP	LD	HL,0DE_CP	LD	DE,0BC_CP	LD	BC,0	INC	HL	DEC	B	JR	NZ,compCMP_NO	LD	A,(REGIM+1)	DEC	A	JR	NZ,NEXT1REMARK	CALL	^_CSR	RES	1,(HL)NEXT1	JP	NEXT;--------------SPACE	CALL	SP_TST	JR	NZ,CMP_NOCMP_OKREGIM	LD	A,22	INC	A	JR	Z,REMARKMARK	CALL	^_CSR	SET	1,(HL)	JR	NEXT1;---------------------SP_TSTCPCSR	LD	A,0	OR	A	RET	Z	INC	B	DEC	B	RET	ZSP_CP	LD	A,(HL)	CP	" "	RET	NZ	INC	HL	DJNZ	SP_CP	RET;----------------------^_CSRFNUMB	LD	A,0	LD	E,A       LD   C,$^_csr	RST	16	EXX	RET;----------------------MASK	LD	HL,#100       LD   C,$wtpos	RST	16	LD	HL,mask	LD	DE,#300       LD   BC,#8100+$smbgt	LD	A,12	RST	16	LD	DE,BUFF+2	LD	BC,12	LDIR	XOR	A	IF	DEBUG	IM	2	END	RET;----------------------QUIT	OR	#FF	RETHOT	DEFB	"m",2,0	DEFB	"k",3,0	DEFB	"j",4,0	IF	1-DEBUG	DEFB	"+",3,0	DEFB	"-",4,0	END	DEFB	" "	DEFW	QUIT	DEFB	#FFENT	DEFW	MASK	DEFW	Mark	DEFW	PLUS	DEFW	MINUS	DEFB	0,0,0,1	DEFW	0,0,HOT,ENT`MENU	DEFB	2,6,6,12,0,0,4,13,1,1,1,1mask	DEFM	|*.*          |	DEFM	|MARK|	DEFB	13	DEFM	|+ Plus|	DEFB	13	DEFM	|- Minus|	DEFB	13;----------------------	IF	DEBUG$RST	PUSH	BC	PUSH	DE	PUSH	HL	PUSH	AF	LD	A,4	CALL	#1601	POP	AF	POP	HL	POP	DE	POP	BC	IM	2	EI;      END	RST	#10;      IF   DEBUG	IM	1;      END	RET	END;**;**FILE	EQU	$BUFF	EQU	FILE+11
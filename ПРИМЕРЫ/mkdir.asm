; 31.12.96  /F: No flush - Fast Food!; 26.12.96  LEVEL;   3.3.95  /s16;  28.9.93  -mkdir,-nwchn,MANUAL;  7.11.91;       mkdir.as;=512/392/256	ORG	25000	IF	.KEY	DEFS	4	END	LD	C,$g_cat	RST	16	EXX	LD	A,D	CP	6	INC	A ; NZ	RET	NC	IF	1-.KEY	XOR	A	LD	IX,curID	LD	C,$p_stat	RST	16	CALL	OPCAT	JP	C,MKDoutMKCSR	LD	A,0	RRA	JR	C,AUTO	END; M A N U A L :	LD	IX,`WIND	LD	C,$g_curs	RST	16	EXX	LD	HL,#104	DJNZ	$+5	LD	HL,#1119	LD	(IX),H	LD	(IX+6),L	LD	A,(COLOR)	LD	(IX+4),A	LD	A,2	LD	C,$wt	RST	16	LD	C,$adrwt	RST	16	LD	HL,FILE+8	LD	B,8	DEC	HL	LD	(HL)," "	DJNZ	$-3WTPOS	EX	DE,HL	LD	HL,#301	LD	C,$wtpos	RST	16	EX	DE,HL	LD	A,8	LD	DE,#A01;      LD   HL,FILE	LD	BC,#100+$smbgt	RST	16	JR	NZ,1$ ;MKDout	OR	A	JR	Z,1$  ;MKDout	LD	A,#20	LD	C,$fncor	RST	16	JR	C,WTPOS	JR	MAKE;-----1$	XOR	A	LD	A,#F8	RET;-----	DEFM	|UnCo|	DEFB	COLSZCOLOR	DEFB	#38COLSZ	EQU	$-COLOR`WIND	DEFB	7,8,5,11,#38,1,0,10	DEFM	|  Create|	DEFB	13	DEFM	|Directory:|	DEFB	3;-----	IF	1-.KEYAUTO	LD	HL,FILE	LD	B,8	PUSH	HL	LD	A,-1	AND	(HL)	INC	HL	DJNZ	$-2	POP	HL	INC	A	JR	Z,MKDout	LD	A,#20	LD	C,$fncor	RST	16	JR	C,MKDout	ENDMAKE	LD	C,$g_com	RST	16	EXX	DEC	HL	DEC	HL	LD	B,(HL)	DEC	HL	LD	C,(HL)	LD	(C_DAY),BC	LD	HL,FILE	CALL	MKDIR	JR	C,MKDout	IF	1-.KEYFlush	LD	A,0	OR	A	JR	NZ,MKDout	END	LD	C,$flush	RST	16MKDout	IF	1-.KEY ; COM ---	PUSH	AF	XOR	A	LD	IX,curID	LD	C,$g_stat	RST	16	POP	BC	RET	C	PUSH	BC	POP	AF	RET	C	LD	C,$opcat	RST	16	END	; --------	RET	C	XOR	A	LD	A,#F2EMPTY	RET;-----	IF	1-.KEYOPCAT	LD	C,$opcat	RST	16	RET	C	RET	NZ	EXX	OR	A	JR	Z,NAME	RES	5,A	CP	"S"	JR	Z,SIZE	LD	C,#40	CP	"C"	JR	Z,1$	LD	C,#80	CP	"P"	JR	Z,1$	CP	"F"	JR	Z,FLUSH	LD	C,#10	CP	"H"	JR	NZ,OPCAT1$	LD	HL,CTCSR	LD	A,C	OR	(HL)	LD	(HL),A	JR	OPCAT;-----SIZE	INC	HL	INC	HL	XOR	A	LD	BC,#A00+$a_d	RST	16	RET	C	EXX	LD	A,L	DEC	A	AND	#F	INC	A	LD	(SZCAT),A	JR	OPCAT;-----NAME	LD	DE,FILE	LD	BC,8	LDIR	LD	HL,MKCSR+1	SET	0,(HL)	JR	OPCAT;-----FLUSH	LD	(Flush+1),A	JR	OPCAT	END;-----FILE	DEFM	|CATALOG    |CTCSR	DEFB	#21	DEFS	3SZCAT	DEFB	3	DEFS	14C_DAY	DEFW	0;-----MKDIR	LD	C,$crfil	RST	16	RET	C	EXX	LD	BC,11	ADD	HL,BC	LD	A,(HL)	LD	C,6	ADD	HL,BC	LD	E,(HL)	INC	HL	LD	D,(HL)	AND	#40	JR	NZ,1$;      LD   C,$quard=6	RST	16	RET	C	EXX	INC	HL	LD	E,(HL)	INC	HL	LD	D,(HL)	PUSH	DE	EXX	POP	DE1$	INC	HL	LD	(HL),E	INC	HL	LD	(HL),D	LD	C,$putf	RST	16	RET	C	PUSH	DE	LD	BC,-20	ADD	HL,BC	LD	BC,#20	LD	DE,FILE	LDIR	LD	C,16 ;OLD level	ADD	HL,BC	LD	A,(HL)	INC	HL ;17	INC	HL	INC	HL ;19	LD	E,(HL)	INC	HL ;20	LD	D,(HL)	INC	HL	INC	HL	INC	HL	OR	(HL) ;NEW level	INC	A	LD	(FILE+12),DE;      LD   (FILE+16),A	LD	(FILE+23),A	LD	A,1	LD	(FILE+21),A	POP	DE	LD	C,$quard	RST	16	RET	C	EXX	PUSH	DE	EX	DE,HL	LD	HL,FILE	LD	BC,#20	LDIR	LD	C,#DF	LD	L,E	LD	H,D	INC	DE	LD	(HL),0	LDIR	POP	DE	LD	C,$modo	RST	16	RET	C; clear directory-file	LD	HL,(FILE+14)	LD	A,L	OR	A	LD	A,H	JR	NZ,$+3	DEC	A	OR	A	RET	Z	LD	B,A	LD	DE,1paste	LD	C,$qrvbl	RST	16	RET	C	EXX	XOR	A	LD	B,A	LD	(HL),A	INC	HL	DJNZ	$-2	PUSH	DE	EXX	POP	HL	EX	DE,HL	LD	C,$modo	RST	16	RET	C	EX	DE,HL	INC	DE	DJNZ	paste	RET;-----	IF	1-.KEYcurID	EQU	$	END;**;**